## 描述

该项目用以替换神州新桥开发的对接splunk查询全行交易金额以及笔数插件

## 实现逻辑

整个项目分了4个功能

1. 日志易spl接口查询数据
2. 起一个API服务
3. 死循环更新一个全局变量
4. 每天0点重置一次全局变量

全局变量为：

```json
{
    "totalTransAmount":0,     # 上一轮spl统计数据（全行交易金额）
    "totalTransCount":0,      # 上一轮spl统计数据（全行交易笔数）
    "lastAmount":0,           # 上一轮spl统计数据（全行交易金额）
    "lastCount":0,            # 上一轮spl统计数据（全行交易笔数）
    "updateTime":0,           # spl查询更新时间
    "tempTotalTransAmount":0, # 实时spl查询生成结果（全行交易金额）
    "tempTotalTransCount":0   # 实时spl查询生成结果（全行交易笔数）
}
```

### 其他说明

1. API返回结果为

   ```json
   {
       "totalTransAmount":0,
       "totalTransCount":0
   }
   ```

2. 死循环更新全局变量用涉及到生成随机数目的

   为了能让大屏的数值翻牌器一直处于滚动状态，大屏几乎每秒都需要通过API接口查询一次数据，为了能让大屏每次都能拿到数据并实现翻牌，所以增加该功能：

   - 生成一个不低于60个数据的数组
   - 数组值范围在：上一轮spl查询结果<=    数组  <= 本轮spl查询结果
   - 当判断出updateTime的值发生了更新，退出当前循环，进入新一轮循环



# BUGS

1. 由于采用了多线程以及线程锁，目前只是想了一个法子（根据锁的顺序）进行全局变量数据更改，不确定是不是百分百有问题

